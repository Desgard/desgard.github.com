---
layout: post
author: Desgard_Duan
title: Socket In Objective-C
category: learning
tag: [iOS]
---

这几天重点回顾一下Objective-C中的网络技术，由于鹅厂的电面对我的刺激很大，所以觉得恶补这一系列知识，把去年看过的东西继续回顾一遍。

## 1.网络各个协议的简单介绍

网络七层自顶向下分别为**物理层**、**数据链路层**、**网络层**、**传输层**、**会话层**、**表示层**和**应用层**。其中物理层、数据链路层和网络层通常称为**媒体层**，网络工程师主要研究于此。传输层、会话层、表示层和应用层呗称作**主机层**，是用户所面向和关心的内容，也就是我们通常所说的**前端**。iOS、Android等一系列工程师主要在此进行深倔。

我们通过一张图，找准**Socket抽象层**的具体位置。它与TCP/IP协议族通信的中间软件抽象层，它是一组接口。

![img](http://img17.poco.cn/mypoco/myphoto/20160310/08/17823283120160310084337090.jpg?542x476_120)

## 2.TCP和UDP的区别

再简述一下两个协议的区别：

* TCP协议：面向连接、传输可靠（保证数据准确性、保证数据顺序）、用于传输大量数据（流模式）、速度慢，简历连接需要开销较多的时间和系统资源。

* UDP协议：面向非连接、传输不可靠、用于传输少量数据（数据包模式）、速度快。

总结一下，TCP是一种流模式的协议，UDP是一种数据报模式的协议，而且说明下，TCP是面向连接的，即在练级持续的过程中，Socket中收到的数据都是由一台主机发出的（当然前提是不考虑数据劫持）。因此，TCP保证数据有序到达。而UDP是无连接协议，即只要知道接收端的IP和端口，且网络是可达的，任何主机都可以向接收端发送数据。这时候，如果一次能取超过一个报文的数据，就会乱套。举例，主机A发送报文P1，主机B发送了报文P2，如果能够读取超过一个报文的数据，那么久将P1、P2的数据合并，造成数据错乱以至于信息丢失。

# 3.对Socket的描述

从即时通讯开始说起。在很多主流的IM软件中，很少有延时和掉线这种体验。它们对Socket的链接进行监视和检测，在断线时进行重新连接，如果用户退出登录，要将Socket手动关闭，否则对服务器造成一定的负荷。

一般的，一个用户只有一个正在连接的Socket，所以这个Socket变量必须是全局的，自然而然的联系到`单例模式`。如果二次对一个已经连接的Socket对象再次进行连接操作，会抛出异常，导致崩溃。所以在连接Socket之前先要对Socket对象的连接状况进行判断。

